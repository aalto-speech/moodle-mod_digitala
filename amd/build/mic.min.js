define ("mod_digitala/mic",["exports","RecordRTC","core/config"],function(a,b,c){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.initializeMicrophone=void 0;b=d(b);c=d(c);function d(a){return a&&a.__esModule?a:{default:a}}var e,f=!1,g,h=function(a,d,h,i){switch(f){case!1:navigator.mediaDevices.getUserMedia({audio:!0}).then(function(a){var c={audioBitsPerSecond:16e3,type:"audio",recorderType:b.default.StereoAudioRecorder,mimeType:"audio/wav",numberOfAudioChannels:1};e=new b.default(a,c);f=!0;e.startRecording();window.console.log("started to record")}).catch(function(a){window.console.error(a)});break;case!0:f=!1;e.stopRecording(function(){var b=e.getBlob();window.console.log("audioBlob:",b);var f=URL.createObjectURL(b);g=new Audio(f);window.console.log("audioUrl",f);if(1===a){window.console.log("fuu >",a,d,h,i);var j=new FormData;j.append("repo_id","5");j.append("ctx_id",c.default.contextid);j.append("itemid","0");j.append("savepath","/");j.append("sesskey",c.default.sesskey);j.append("repo_upload_file",b,"ans-".concat(d,"-").concat(h,"-").concat(i,"-").concat(new Date().valueOf(),".wav"));j.append("overwrite","1");var k=new XMLHttpRequest;k.open("POST",c.default.wwwroot+"/repository/repository_ajax.php?action=upload");k.addEventListener("readystatechange",function(a){window.console.log(a);window.console.log(JSON.parse(a.target.response));document.forms.answerrecording[0].value=a.target.response;window.console.log("Enable submit button");document.getElementById("id_submitbutton").style.display=""});k.send(j)}});window.console.log(M.cfg);window.console.log("recording stopped");break;}},i=function(){var a=document.getElementById("microphoneIconBox");if(g!==void 0){g.play();a.style.border="2.5px dashed green"}else{a.style.border="2.5px dashed red"}};a.initializeMicrophone=function initializeMicrophone(a,b,c,d){window.console.log("Starting to initalize microphones");if(2!==a){var e=document.getElementById("record"),f=document.getElementById("stopRecord"),g=document.getElementById("listenButton");g.disabled=!0;window.console.log("page number",a);e.onclick=function(){e.disabled=!0;f.disabled=!1;g.disabled=!0;e.style.display="none";f.style.display="inline-block";h(a,b,c,d)};f.onclick=function(){e.disabled=!1;f.disabled=!0;g.disabled=!1;e.style.display="inline-block";f.style.display="none";h(a,b,c,d)};g.onclick=function(){i()}}}});
//# sourceMappingURL=mic.min.js.map
