define("mod_digitala/mic",["exports","RecordRTC","core/config"],(function(_exports,_RecordRTC,_config){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}
/*
   * @module     mod_digitala/mic
   * @copyright  2022 Name
   * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
   */var recorder;Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.initializeMicrophone=void 0,_RecordRTC=_interopRequireDefault(_RecordRTC),_config=_interopRequireDefault(_config);var audio,isRecording=!1,startStopRecording=function(pagenum,assignmentId,userId,username){switch(isRecording){case!1:navigator.mediaDevices.getUserMedia({audio:!0}).then((function(stream){var options={audioBitsPerSecond:16e3,type:"audio",recorderType:_RecordRTC.default.StereoAudioRecorder,mimeType:"audio/wav",numberOfAudioChannels:1};recorder=new _RecordRTC.default(stream,options),isRecording=!0,recorder.startRecording()})).catch((function(err){window.console.error(err)}));break;case!0:isRecording=!1,recorder.stopRecording((function(){var audioBlob=recorder.getBlob(),audioUrl=URL.createObjectURL(audioBlob);if(audio=new Audio(audioUrl),1===pagenum){var form=new FormData;form.append("repo_id","5"),form.append("ctx_id",_config.default.contextid),form.append("itemid","0"),form.append("savepath","/"),form.append("sesskey",_config.default.sesskey),form.append("repo_upload_file",audioBlob,"ans-".concat(assignmentId,"-").concat(userId,"-").concat(username,"-").concat((new Date).valueOf(),".wav")),form.append("overwrite","1");var req=new XMLHttpRequest;req.open("POST",_config.default.wwwroot+"/repository/repository_ajax.php?action=upload"),req.addEventListener("readystatechange",(function(event){document.forms.answerrecording[0].value=event.target.response,document.getElementById("submitModalButton").style.display=""})),req.send(form)}}))}};_exports.initializeMicrophone=function(pagenum,assignmentId,userId,username){if(2!==pagenum){var recButton=document.getElementById("record"),stopButton=document.getElementById("stopRecord"),listenButton=document.getElementById("listenButton");listenButton.disabled=!0,recButton.onclick=function(){recButton.disabled=!0,stopButton.disabled=!1,listenButton.disabled=!0,recButton.style.display="none",stopButton.style.display="inline-block",startStopRecording(pagenum,assignmentId,userId,username)},stopButton.onclick=function(){recButton.disabled=!1,stopButton.disabled=!0,listenButton.disabled=!1,recButton.style.display="inline-block",stopButton.style.display="none",startStopRecording(pagenum,assignmentId,userId,username)},listenButton.onclick=function(){var microphoneIcon;microphoneIcon=document.getElementById("microphoneIconBox"),void 0!==audio?(audio.play(),microphoneIcon.style.border="2.5px dashed green"):microphoneIcon.style.border="2.5px dashed red"}}}}));

//# sourceMappingURL=mic.min.js.map