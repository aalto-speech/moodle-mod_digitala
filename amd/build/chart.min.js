define("mod_digitala/chart",["exports","chart","core/str"],(function(_exports,_chart,_str){var obj;
/*
   * @module     mod_digitala/mic
   * @copyright  2022 Name
   * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
   */Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.init=void 0,_chart=(obj=_chart)&&obj.__esModule?obj:{default:obj};const createChart=async(id,grade,maxgrade)=>{const horLine={afterDraw:chart=>{const ctx=chart.ctx;ctx.lineWidth=3.5;const scale=chart.chartArea.width/maxgrade,curr=chart.config._config.options.lineAt,place=chart.chartArea.left+scale*curr;ctx.strokeStyle="#ffb000",ctx.beginPath(),ctx.moveTo(place,chart.chartArea.top),ctx.lineTo(place,chart.chartArea.bottom),ctx.closePath(),ctx.stroke()}},kaavio=document.getElementById(id).getContext("2d");let strings=[],basicDataset=[];for(let i=0;i<=maxgrade;i++)strings=[...strings,{key:"".concat(id,"_score-").concat(i),component:"digitala"}],i>=1&&(basicDataset=[...basicDataset,{type:"bar",label:"noshow",data:[1],backgroundColor:i%2?"rgba(182, 182, 182, 0.3)":"rgba(123, 123, 123, 0.3)"}]);let lineSet=[];const evalStrings=await(0,_str.get_strings)(strings);for(let i=0;i<evalStrings.length;i++){const evalString=evalStrings[i],length=0===i?0:1;lineSet=[...lineSet,{type:"line",label:evalString,data:[length],backgroundColor:"rgba(0, 0, 0, 1)",showLine:!0,pointRadius:12.5}]}const selectedDataset=[...lineSet,...basicDataset];new _chart.default.Chart(kaavio,{type:"bar",data:{labels:[""],datasets:selectedDataset},plugins:[horLine],options:{plugins:{legend:{display:!1},tooltip:{enabled:!1,external:tooltipModel=>{const name=tooltipModel.chart.canvas.attributes["data-eval-name"].value,tooltip=tooltipModel.tooltip,getBody=bodyItem=>bodyItem.lines;let tooltipBox=document.getElementById("grade-tooltip-".concat(name));if(tooltipBox||(tooltipBox=document.createElement("div"),tooltipBox.classList.add("tooltip-box"),tooltipBox.id="grade-tooltip-".concat(name),document.body.appendChild(tooltipBox)),tooltip.body){if("noshow"===tooltip.body.map(getBody)[0][0].split(":")[0])return void(tooltipBox.style.opacity=0)}if(0===tooltip.opacity)return void(tooltipBox.style.opacity=0);if(tooltipBox.classList.remove("above","below","no-transform"),tooltip.yAlign?tooltipBox.classList.add(tooltip.yAlign):tooltipBox.classList.add("no-transform"),tooltip.body){tooltip.body.map(getBody).forEach((body=>{tooltipBox.innerHTML='<p class="tooltip-text">'+body[0].split(":")[0]+"</p>"}))}const position=tooltipModel.chart.canvas.getBoundingClientRect();tooltipBox.style.opacity=1,tooltipBox.style.position="absolute";let left="right"===tooltip.xAlign?position.left+window.pageXOffset-200+tooltip.caretX:position.left+window.pageXOffset+tooltip.caretX;tooltipBox.style.left=left+"px",tooltipBox.style.top=position.top+window.pageYOffset+tooltip.caretY+"px",tooltipBox.style.pointerEvents="none"}}},lineAt:grade,indexAxis:"y",responsive:!0,maintainAspectRatio:!1,scales:{x:{stacked:!0,ticks:{font:{size:16}}},y:{stacked:!0}}}})};_exports.init=()=>{const allCanvases=document.getElementsByClassName("report-chart");for(let i=0;i<allCanvases.length;i++){const canvas=allCanvases[i];createChart(canvas.attributes["data-eval-name"].value,canvas.attributes["data-eval-grade"].value,canvas.attributes["data-eval-maxgrade"].value)}}}));

//# sourceMappingURL=chart.min.js.map